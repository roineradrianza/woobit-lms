let vm=new Vue({vuetify:vuetify,el:"#full-learning-container",data:{current_url:current_url,course_tab:null,tab:null,nav_tab:null,loading:!1,coupon_loading:!1,certified_loading:!1,coupon_field:!1,stepper_dialog:!0,modal_course:!0,alert:!1,alert_type:"",alert_message:"",course_id:"",stepper:1,selection:2,coupon_code:"",notifications:[],sponsors:[],sponsors_posts:[],sponsors_posts_filtered:[],rating:{my_rating:{},items:[],loading:!1,form_valid:!0,form_loading:!1,myCommentIsPublished:!1,form_rules:{comment:[s=>!!s||"Es requerido escribir un comentario",s=>s&&s.length<=10||"Debe ser un comentario mayor a 10 caracteres"]},form:{comment:"",stars:5},defaultForm:{comment:"",stars:5}},my_progress:{progress:"N/A",quizzes_approved:0,total_quizzes:0,quizzes:[],certified:""}},computed:{},created(){check_google_user()},mounted(){this.course_id=this.$refs.course_container.getAttribute("course_id"),null!=url_params.get("course_tab")&&(this.course_tab=url_params.get("course_tab"),setTimeout(()=>{this.$refs.tabs_section.$el.scrollIntoView({behavior:"smooth"})},2e3)),this.initializeSponsors(),this.initializeSponsorsPosts(),this.initializeComments()},methods:{initializeSponsors(){var s=this,o=api_url+"sponsors/get-by-course/"+s.course_id;s.$http.get(o).then(o=>{o.body.length>0&&(s.sponsors=o.body)},s=>{})},initializeSponsorsPosts(){var s=this,o=api_url+"sponsors-posts/get/"+s.course_id;s.$http.get(o).then(o=>{o.body.length>0&&(s.sponsors_posts_filtered=_.shuffle(o.body),s.sponsors_posts=o.body)},s=>{})},initializeComments(){var s=this,o=api_url+"course-ratings/get/"+s.course_id;if(s.rating.loading=!0,s.$http.get(o).then(o=>{s.rating.items=o.body,s.rating.loading=!1},o=>{s.rating.loading=!1}),"undefined"!=typeof basic_info){o=api_url+"course-ratings/get-mine/"+s.course_id;s.rating.loading=!0,s.$http.post(o).then(o=>{o.body.length>0&&(s.rating.myCommentIsPublished=!0,o.body[0].stars=parseInt(o.body[0].stars),s.rating.my_rating=o.body[0]),s.rating.loading=!1},o=>{s.rating.loading=!1})}},initializeCourseProgress(){var s=this,o={course_id:s.course_id},t=api_url+"course-students/get-student-progress-total";s.certified_loading=!0,s.$http.post(t,o).then(o=>{s.my_progress=o.body,s.certified_loading=!1},o=>{s.certified_loading=!1})},saveSponsorView(s){var o=this;o.$http.post(api_url+"sponsor-views/create",{sponsor_id:s,course_id:o.course_id}).then(s=>{})},saveSponsorPostView(s){var o=this;o.$http.post(api_url+"sponsor-post-views/create",{sponsor_post_id:s,course_id:o.course_id}).then(s=>{console.log(s)})},saveRating(){var s=this,o=api_url+"course-ratings/create";if(!s.$refs.rating_form.validate())return!1;s.rating.form_loading=!0;var t={course_id:s.course_id,comment:s.rating.form.comment,stars:s.rating.form.stars};s.$http.post(o,t).then(o=>{s.rating.form_loading=!1,"success"==o.body.status&&(t.published_at=moment().format("YYYY-MM-DD h:mm:ss"),t.course_rating_id=o.body.data.course_rating_id,s.rating.my_rating=t,s.rating.myCommentIsPublished=!0)},o=>{s.rating.form_loading=!1})},editMyRating(){var s=this,o=api_url+"course-ratings/update";s.rating.form_loading=!0,s.rating.form.course_id=s.course_id,s.$http.post(o,s.rating.form).then(o=>{s.rating.form_loading=!1,"success"==o.body.status&&(s.rating.my_rating=s.rating.form,s.rating.myCommentIsPublished=!0)},o=>{s.rating.form_loading=!1})},deleteMyRating(){var s=this,o=api_url+"course-ratings/delete";s.$http.post(o,{course_rating_id:s.rating.my_rating.course_rating_id}).then(o=>{"success"==o.body.status&&(s.rating.myCommentIsPublished=!1,s.rating.my_rating={},s.rating.form=Object.assign({},s.rating.defaultForm))},s=>{})},filterSponsorPosts(s){var o=this;o.saveSponsorView(s);var t=_.filter(o.sponsors_posts,o=>o.sponsor_id==s),e=_.filter(o.sponsors_posts,o=>o.sponsor_id!=s);o.sponsors_posts_filtered=t,e.forEach(s=>{o.sponsors_posts_filtered.push(s)})},checkCoupon(s){var o=this,t=api_url+"coupons/apply-coupon",e={course_id:s,coupon_code:o.coupon_code};o.coupon_loading=!0,o.$http.post(t,e).then(s=>{o.coupon_loading=!1,o.alert=!0,o.alert_type=s.body.status,o.alert_message=s.body.message,"success"==s.body.status&&location.reload()},s=>{o.coupon_loading=!1})},enrollToCourse(s){var o=this,t=api_url+"course-students/enroll-free-course",e={course_id:s};o.coupon_loading=!0,o.$http.post(t,e).then(s=>{o.coupon_loading=!1,o.alert=!0,o.alert_type=s.body.status,o.alert_message=s.body.message,"success"==s.body.status&&location.reload()},s=>{o.coupon_loading=!1})},openTab(s){window.scrollTo(0,this.$refs.tabs_section.$el.scrollWidth),this.course_tab=s},setCookie(){var s=this;let o="",t=new Date;t.setTime(t.getTime()+31536e6),o="; expires="+t.toUTCString(),document.cookie="modalv1_course_"+s.course_id+"=closed"+o+"; path=/",s.modal_course=!1},saveFile(s,o){var t=this;o=void 0===o?t:o;var e=s.substring(s.lastIndexOf("/")+1).split("?")[0];t.$http.get(s,{responseType:"blob",progress(s){}}).then(s=>{var o=document.createElement("a");o.href=window.URL.createObjectURL(s.body),o.download=e,o.style.display="none",document.body.appendChild(o),o.click(),delete o})}}});