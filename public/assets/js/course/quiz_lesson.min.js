const splitted_domain=window.location.href.split("/"),course_slug=splitted_domain[4],lesson_id=splitted_domain[5];Vue.component(VueCountdown.name,VueCountdown),moment.locale("es");let vm=new Vue({vuetify:vuetify,el:"#full-learning-container",data:{drawer:!1,tab:null,nav_tab:null,alert:!1,loading:!1,send_quiz_loading:!1,certified_approved_dialog:!1,certified_loading:!1,certified_url:"",requireCertifiedPaid:!1,alert_message:"",alert_type:"",selection:1,quiz_countdown:16e3,quiz_started:!1,quiz_finished:!1,counting:!1,meta:{},notifications:[],attempt_results:[],quiz_results:[],quiz:[]},computed:{},watch:{quiz_started(e){e&&(this.counting=!0,window.addEventListener("scroll",this.handleScroll))}},created(){this.initialize(),this.initializeQuizAttempts(),this.initializeQuiz()},mounted(){},methods:{initialize(){var e=this,t=api_url+"course-lessons/get-meta-info/"+lesson_id;e.loading=!0,e.$http.get(t).then(t=>{t.body.length>0&&t.body.forEach(t=>{e.meta[t.lesson_meta_name]=t.lesson_meta_val,"quiz_duration"==t.lesson_meta_name&&(countdown=t.lesson_meta_val,e.quiz_countdown=6e4*countdown)}),e.loading=!1},e=>{})},initializeQuizAttempts(){var e=this,t=api_url+"lesson-quizzes/get-attempt/"+lesson_id;e.loading=!0,e.$http.get(t).then(t=>{(t.body.hasOwnProperty("attempt_data")||t.body.hasOwnProperty("quiz_results"))&&(e.attempt_results=t.body.attempt_data,e.quiz_results=t.body.quiz_results,e.attempt_results.hasOwnProperty("approved")&&(e.quiz_finished=!0)),e.loading=!1},e=>{})},initializeQuiz(){var e=this,t=api_url+"lesson-quizzes/get-questions/"+lesson_id;e.loading=!0,e.$http.get(t).then(t=>{e.loading=!1,e.quiz=t.body},e=>{})},saveQuiz(e=!0){var t=this,a=t.checkEmptyAnswers();if(a>0&&e){var s=a>1?"preguntas":"pregunta";return t.alert=!0,t.alert_message="Por favor revisa nuevamente el quiz, tienes "+a+" "+s+" sin responder",t.alert_type="warning",!1}t.send_quiz_loading=!0,t.counting=!1;var r={meta:t.meta,lesson:{lesson_id:lesson_id},answers:t.quiz};t.$refs.countdown_component1.abort(),t.$refs.countdown_component2.abort();var i=api_url+"lesson-quizzes/save-attempt";t.$http.post(i,r).then(e=>{t.$refs.quiz_form.reset(),t.quiz_finished=!0,t.send_quiz_loading=!1,t.attempt_results=e.body.data.attempt_data,t.quiz_results=e.body.data.quiz_results,window.scrollTo(0,0),"success"==e.body.status&&(e.body.data.hasOwnProperty("certified_url")&&""!==e.body.data.certified_url||e.body.data.hasOwnProperty("requireCertifiedPaid")&&2!=e.body.data.requireCertifiedPaid)&&(t.certified_url=e.body.data.certified_url,t.requireCertifiedPaid=e.body.data.requireCertifiedPaid,t.certified_approved_dialog=!0)},e=>{t.send_quiz_loading=!1})},handleScroll(){if(!this.quiz_finished){var e=this.$refs.countdown_row,t=this.$refs.countdown.scrollWidth,a=window.scrollY>t?1:0;a?(e.classList.contains("d-flex")||e.classList.remove("d-none"),e.classList.add("d-flex")):(e.classList.contains("d-none")||e.classList.remove("d-flex"),e.classList.add("d-none"))}},transformSlotProps(e){const t={};return Object.entries(e).forEach(([e,a])=>{t[e]=a<10?`0${a}`:String(a)}),t},checkEmptyAnswers(){var e=this,t=0;return e.quiz.forEach(e=>{""!=e.correct_answer&&0!=e.correct_answer.lenght||t++}),t>0&&t},getTimeDifference:e=>moment(e).diff(moment().format()),formatDate:e=>moment(e).format("LLL"),replaceString:(e,t,a)=>e.replace(t,a),replaceMissingWords(e,t){var a=e.answer,s=/\[([^\]]+)]/g,r=null!=a.match(s)?a.match(s):[];r.forEach((s,r)=>{var i=`\n            <span class="pr-1 mr-4 v-badge theme--light">\n              <span class="v-badge__wrapper">\n                <span aria-atomic="true" aria-label="Badge" \n                aria-live="polite" role="status" class="v-badge__badge primary" \n                style="inset: auto auto calc(100% - 4px) calc(100% - 4px);">${r+1}\n                </span>\n              </span>\n            </span>\n          `;e.answer=a.replace(s,i),t.correct_answer=[],t.correct_answer.push()})},replaceMissingWordsReview(e,t){var a=e.answer,s=/\[([^\]]+)]/g,r=null!=a.match(s)?a.match(s):[];r.forEach((t,s)=>{var r=`\n            <span class="pr-1 mr-4 v-badge theme--light">\n              <span class="v-badge__wrapper">\n                <span aria-atomic="true" aria-label="Badge" \n                aria-live="polite" role="status" class="v-badge__badge primary" \n                style="inset: auto auto calc(100% - 4px) calc(100% - 4px);">${s+1}\n                </span>\n              </span>\n            </span>\n          `;e.answer=a.replace(t,r)})},parseAnswers(e){Array.isArray(e.correct_answer)||(e.correct_answer=JSON.parse(e.correct_answer))},checkWords(e,t,a){var s=t.correct_answer[a],r=e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()==s.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase();return r},getWords:(e,t,a)=>(input=t.correct_answer[a],input),saveFile(e,t){var a=this;t=void 0===t?a:t;var s=e.substring(e.lastIndexOf("/")+1).split("?")[0];a.$http.get(e,{responseType:"blob",progress(e){e.lengthComputable&&(t.percent_loading_active=!0,t.percent_loading=e.loaded/e.total*100)}}).then(e=>{var t=document.createElement("a");t.href=window.URL.createObjectURL(e.body),t.download=s,t.style.display="none",document.body.appendChild(t),t.click(),delete t})}}});