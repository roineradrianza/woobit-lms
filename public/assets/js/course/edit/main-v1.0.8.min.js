const splitted_domain=window.location.href.split("/"),course_id=splitted_domain[5];let vm=new Vue({vuetify:vuetify,el:"#full-learning-container",data:{tab:null,nav_tab:null,alert:!1,dialog:!1,reminder:!1,loading:!1,page_loading:!1,image_loading:!1,general_loading:!1,setup_loading:!1,image_certified_by_loading:!1,percent_loading_active:!1,valid:!1,dialogDelete:!1,birthdateDialog:!1,zoomDateDialog:!1,zoomTimeDialog:!1,birthdate_modal:!1,zoom_date_modal:!1,zoom_time_modal:!1,drawer:!0,modal:!1,alert_message:"",alert_type:"",previewImage:"",previewCertifiedBy:"",currentImage:"",currentCertifiedBy:"",selectedItem:4,percent_loading:0,validations:validations,featured_image:"",certified_by:"",faq:{add_loading:!1,items:[],customToolbar:[["bold","italic","underline"],[{list:"ordered"},{list:"bullet"}]]},curriculum:{loading:!1,add_loading:!1,add_lesson_loading:!1,add_quiz_loading:!1,update_section_loading:!1,update_lesson_loading:!1,update_lesson_meta_loading:!1,sections:[],customToolbar:[["bold","italic","underline"],[{list:"ordered"},{list:"bullet"}]]},notifications:[],levels:[{text:"Principiante",value:"principiante"},{text:"Intermedio",value:"intermedio"},{text:"Avanzado",value:"avanzado"}],true_false:[{text:"Activo",value:"1"},{text:"Inactivo",value:"0"}],lessons:{loading:!1,quiz_options:[{text:"Selecci칩n simple",value:"1"},{text:"Verdadero o Falso",value:"2"},{text:"Completaci칩n",value:"3"}],types:[{text:"Clase",value:"1"},{text:"Quiz",value:"2"},{text:"Actividades",value:"3"},{text:"Recursos",value:"4"}],class_types:[{text:"Video",value:"video"},{text:"Zoom",value:"zoom_meeting"}],item:{quizzes:[],meta:{class_type:"",duration:"",description:"",zoom_agenda:"",zoom_duration:"",zoom_date:"",zoom_time:"",zoom_start_time:"",zoom_timezone:"",video:void 0,poster:void 0}},itemMetaDefault:{class_type:"",duration:"",description:"",zoom_description:"",video:void 0,poster:void 0},editedLessonIndex:-1,editedSectionIndex:-1},categories:[],subcategories:[],filtered_subcategories:[],timezones:[],course:{featured_image:"",title:"",slug:"",price:"",duration:"",category:"",level:"",user_id:"",active:0,course_id:course_id,meta:{description:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Ipsa sunt aspernatur eveniet cupiditate soluta architecto ducimus, fuga. Quo voluptatem eligendi, harum eius nostrum veniam minima iste illo explicabo adipisci, voluptate!",certified_by:"",instructors:[]}},instructors:{loading:!1,instructors_loading:!1,add_loading:!1,searched:!1,alert:!1,alert_type:"",alert_message:"",user_selected:"",items:[],users:[],username_search:""}},computed:{},watch:{dialog:function(e){e||this.close()},dialogDelete:function(e){e||this.closeDelete()}},created:function(){window.onload=()=>{check_google_user()},this.editedItem=this.defaultItem,this.initialize(),this.initializeCategories(),this.initializeSubCategories(),this.initializeTimezones()},mounted:function(){this.reminder=!0},methods:{initialize:function(){var e=api_url+"courses/get/"+this.course.course_id;this.page_loading=!0,this.$http.get(e).then(e=>{this.page_loading=!1,this.course=e.body[0],this.getInstructors(),this.course.meta.hasOwnProperty("certified_by")&&(this.currentCertifiedBy=this.course.meta.certified_by,this.previewCertifiedBy=this.course.meta.certified_by),this.course.meta.hasOwnProperty("faq")&&(this.course.meta.faq=JSON.parse(this.course.meta.faq),this.faq.items=this.course.meta.faq),this.currentImage=this.course.featured_image,this.previewImage=this.currentImage,this.getSections()},e=>{})},initializeCategories:function(){var e=api_url+"categories/get";this.categories_loading=!0,this.$http.get(e).then(e=>{this.categories_loading=!1,this.categories=e.body},e=>{})},initializeSubCategories:function(){var e=api_url+"subcategories/get";this.subcategories_loading=!0,this.$http.get(e).then(e=>{this.subcategories_loading=!1,this.subcategories=e.body,this.filtered_subcategories=e.body},e=>{})},initializeTimezones:function(){var t=this,e=domain+"/timezones.min.json";t.$http.get(e).then(e=>{t.timezones=e.body.timezone},e=>{})},getInstructors:function(){var t=this,e=api_url+"courses/get-instructors/"+t.course.course_id;t.$http.get(e).then(e=>{t.instructors.items=e.body},e=>{})},getSections:function(){var e=this,t={course_id:e.course.course_id},s=api_url+"course-sections/get";e.$http.post(s,t).then(s=>{s.body!={}&&s.body.forEach((e,t)=>{0<s.body[t].items.length&&s.body[t].items.forEach((e,t)=>{Array.isArray(e.meta)&&(e.meta={})})}),e.curriculum.sections=s.body},e=>{})},searchUser:function(){var t=this,e=api_url+"members/search-user/"+t.instructors.username_search;t.instructors.alert=!1,t.instructors.searched=!1,t.instructors.user_selected="",t.instructors.loading=!0,t.$http.get(e).then(e=>{t.instructors.loading=!1,t.instructors.searched=!0,t.instructors.users=e.body},e=>{})},saveGeneral:function(){var t=this;t.general_loading=!0;var e=t.course;let s=new FormData;s.append("featured_image",e.featured_image),s.append("title",e.title),s.append("duration",e.duration),s.append("price",parseFloat(e.price)),s.append("level",e.level),s.append("active",e.active),s.append("meta",JSON.stringify(e.meta)),s.append("user_id",e.user_id),s.append("platform_owner",e.platform_owner),s.append("course_id",e.course_id),s.append("category_id",e.category_id),s.append("subcategory_id",e.subcategory_id);e=api_url+"courses/update";t.$http.post(e,s).then(e=>{"success"==e.body.status&&(t.course.slug=e.body.data.slug),t.general_loading=!1},e=>{t.general_loading=!1})},saveSetup:function(){var t=this;t.setup_loading=!0;var e=t.course;let s=new FormData;var i={zoom_jwt:e.meta.zoom_jwt,zoom_host:e.meta.zoom_host};s.append("meta",JSON.stringify(i)),s.append("course_id",e.course_id);e=api_url+"courses/update-meta";t.$http.post(e,s).then(e=>{e.body.status,t.setup_loading=!1},e=>{t.setup_loading=!1})},saveInstructor:function(){var e,t,s=this;s.instructors.alert=!1,s.checkInstructor(s.instructors.user_selected)?(s.instructors.alert=!0,s.instructors.alert_message="El usuario ya se encuentra a침adido como profesor",s.instructors.alert_type="warning"):(s.instructors.add_loading=!0,e=api_url+"courses/add-instructor",t={course_id:s.course.course_id,user_id:s.instructors.user_selected.user_id},s.$http.post(e,t).then(e=>{"success"==e.body.status&&s.instructors.items.push(s.instructors.user_selected),s.instructors.add_loading=!1},e=>{s.instructors.add_loading=!1}))},saveFAQ:function(){var t=this;t.faq.add_loading=!0;var e=api_url+"courses/update-meta";let s=new FormData;s.append("course_id",t.course.course_id),s.append("meta",JSON.stringify({faq:t.faq.items})),t.$http.post(e,s).then(e=>{t.faq.add_loading=!1},e=>{t.faq.add_loading=!1})},checkInstructor:function(t){return 0<this.instructors.items.filter(e=>e.user_id==t.user_id).length},removeInstructor:function(e){var t=this;t.instructors.add_loading=!0;var s=api_url+"courses/remove-instructor",i=t.instructors.items.indexOf(e),e={course_id:t.course.course_id,user_id:e.user_id};t.$http.post(s,e).then(e=>{"success"==e.body.status&&t.instructors.items.splice(i,1),t.instructors.add_loading=!1},e=>{t.instructors.add_loading=!1})},prevImage:function(e){var t=e.target.files[0];const s=new FileReader;s.readAsDataURL(t),s.onload=e=>{this.course.featured_image=t,this.previewImage=e.target.result}},prevCertifiedByImage:function(e){var t=e.target.files[0];const s=new FileReader;s.readAsDataURL(t),s.onload=e=>{this.course.meta.certified_by=t,this.previewCertifiedBy=e.target.result}},resetImage:function(){this.previewImage=this.currentImage,this.course.featured_image=this.currentImage},resetCertifiedByImage:function(){var e=this;""!=e.currentCertifiedBy?(e.previewCertifiedBy=e.currentCertifiedBy,e.course.meta.certified_by=e.currentCertifiedBy):e.previewCertifiedBy=""},saveFeaturedImage:function(){var t=this;t.image_loading=!0;var e=t.course;let s=new FormData;s.append("featured_image",e.featured_image),s.append("slug",e.slug),s.append("course_id",e.course_id);e=api_url+"courses/update-cover";t.$http.post(e,s).then(e=>{"success"==e.body.status&&(t.currentImage=e.body.data.featured_image,t.course.featured_image=e.body.data.featured_image),t.image_loading=!1},e=>{t.image_loading=!1})},saveCertifiedByImage:function(){var t=this;t.image_certified_by_loading=!0;var e=t.course;let s=new FormData;s.append("certified_by_image",e.meta.certified_by),s.append("slug",e.slug),s.append("course_id",e.course_id);e=api_url+"courses/update-certified-by";t.$http.post(e,s).then(e=>{"success"==e.body.status&&(t.currentCertifiedBy=e.body.data.certified_by_image,t.course.meta.certified_by=e.body.data.certified_by_image),t.image_certified_by_loading=!1},e=>{t.image_certified_by_loading=!1})},filterSubcategories:function(){var t=this;t.$refs.subcategory_select.reset(),t.course.subcategory_id="";var e=t.subcategories.filter(e=>e.category_id==t.course.category_id);t.filtered_subcategories=e},getCategory:function(t){var e=this.categories.filter(e=>e.category_id==t);if(0<e.length)return e[0].name},getSubCategory:function(t){var e=this.subcategories.filter(e=>e.subcategory_id==t);if(0<e.length)return" / "+e[0].name},addFAQ:function(){var e=this.faq.items.length;e++,this.faq.items.push({name:"",id:e,text:""})},addSection:function(){var t=this;t.curriculum.add_loading=!0;var e=t.curriculum.sections.length,s=-1==e?0:e,i={section_name:"Secci칩n "+ ++e,section_id:e,section_order:s,items:[],course_id:t.course.course_id},s=api_url+"course-sections/create";t.$http.post(s,i).then(e=>{"success"==e.body.status&&(i.section_id=e.body.data.section_id,i.old_section_name=i.section_name,i.old_section_order=i.section_order,t.curriculum.sections.push(i)),t.curriculum.add_loading=!1},e=>{t.curriculum.add_loading=!1})},updateSection:function(t){var s=this;s.curriculum.update_section_loading=!0;var i=s.curriculum.sections.indexOf(t);t.course_id=s.course.course_id,t.section_order=i;var e=api_url+"course-sections/update";s.$http.post(e,t).then(e=>{"success"==e.body.status&&(t.old_section_order=t.section_order,t.old_section_name=t.section_name,Object.assign(s.curriculum.sections[i],t)),s.curriculum.update_section_loading=!1},e=>{s.curriculum.update_section_loading=!1})},addLesson:function(t,e){var s=this;s.curriculum.add_lesson_loading=!0;var i=s.curriculum.sections[t],e=i.items.indexOf(e),o=-1==e?0:e,e=i.items.length,a={lesson_name:"Clase "+ ++e,old_lesson_name:"Clase "+e,lesson_type:1,lesson_order:o,meta:{},quizzes:[],section_id:i.section_id},i=api_url+"course-lessons/create";s.$http.post(i,a).then(e=>{"success"==e.body.status&&(a.lesson_id=e.body.data.lesson_id,a.old_lesson_order=o,s.curriculum.sections[t].items.push(a)),s.curriculum.add_lesson_loading=!1},e=>{s.curriculum.add_lesson_loading=!1})},addQuestion:function(){var t=this;t.curriculum.add_quiz_loading=!0;var s=t.curriculum.sections[t.lessons.editedSectionIndex].items[t.lessons.editedLessonIndex],e=t.lessons.item.hasOwnProperty("quizzes")?t.lessons.item.quizzes.length+1:1,i={question_name:"Pregunta "+e,old_question_name:"Pregunta "+e,question_type:"1",score:1,question_answers:[],correct_answer:"",lesson_id:s.lesson_id},e=api_url+"lesson-quizzes/create";t.$http.post(e,{lesson:s,quiz:i}).then(e=>{"success"==e.body.status&&(t.curriculum.add_quiz_loading=!1,i.question_id=e.body.data.question_id,t.lessons.item.hasOwnProperty("quizzes")?t.lessons.item.quizzes.push(i):t.lessons.item.quizzes=[i],s.quizzes=Object.assign({},t.lessons.item.quizzes))},e=>{t.curriculum.add_quiz_loading=!1})},addQuestionAnswer:function(e){var t="Respuesta "+(e.question_answers.length+1);e.question_answers.push({answer:t}),e.question_name+=" "},updateLessonMeta:function(){var t=this;t.curriculum.update_lesson_meta_loading=!0;var e,s,i=t.lessons.item;1==i.lesson_type?(e=new FormData,s=api_url+"course-lessons/update-class-lesson-meta/",e.append("course_id",t.course.course_id),e.append("lesson_id",i.lesson_id),e.append("class_type",i.meta.class_type),e.append("send_publish_email",i.meta.send_publish_email),e.append("description",i.meta.description),e.append("duration",i.meta.duration),"video"==i.meta.class_type?(e.append("poster",i.meta.poster),e.append("video",i.meta.video)):"zoom_meeting"==i.meta.class_type&&(e.append("zoom_topic",i.lesson_name),e.append("zoom_jwt",t.course.meta.zoom_jwt),e.append("zoom_host",t.course.meta.zoom_host),e.append("zoom_duration",i.meta.zoom_duration),e.append("zoom_date",i.meta.zoom_date),e.append("zoom_time",i.meta.zoom_time),e.append("zoom_timezone",i.meta.zoom_timezone),e.append("zoom_start_time",moment(i.meta.zoom_date+" "+i.meta.zoom_time).format()),e.append("zoom_agenda",i.meta.zoom_agenda))):2==i.lesson_type&&(e={lesson:i,course:{course_id:t.course.course_id,title:t.course.title,slug:t.course.slug}},s=api_url+"course-lessons/update-quiz-lesson-meta/"),t.$http.post(s,e,{progress:function(e){e.lengthComputable&&(t.percent_loading_active=!0,t.percent_loading=e.loaded/e.total*100)}}).then(e=>{t.percent_loading_active=!1,t.curriculum.update_lesson_meta_loading=!1,t.alert=!0,t.alert_type=e.body.status,t.alert_message=e.body.message,"success"==e.body.status&&("video"==i.meta.class_type?(i.meta.video_url=(e.body.data.hasOwnProperty("video_url")?e.body.data:i.meta).video_url,i.meta.poster_url=e.body.data.hasOwnProperty("poster_url")?e.body.data.poster_url:i.meta.video_url):"zoom"==i.meta.class_type&&(i.meta.zoom_id=e.body.data.zoom_id,i.meta.zoom_url=e.body.data.zoom_url),Object.assign(t.curriculum.sections[t.lessons.editedSectionIndex].items[t.lessons.editedLessonIndex].meta,i.meta))},e=>{t.percent_loading_active=!1,t.curriculum.update_lesson_meta_loading=!1})},updateLesson:function(t,s){var i=this;i.curriculum.update_lesson_loading=!0;var e=i.curriculum.sections[t],o=e.items.indexOf(s),a=-1==o?0:o;s.section_id=e.section_id,s.lesson_order=a;e=api_url+"course-lessons/update";i.$http.post(e,s).then(e=>{"success"==e.body.status&&(s.old_lesson_order=s.lesson_order,s.old_lesson_name=s.lesson_name,Object.assign(i.curriculum.sections[t].items[a],s)),i.curriculum.update_lesson_loading=!1},e=>{i.curriculum.update_lesson_loading=!1})},updateQuestion:function(t){var s=this;s.curriculum.update_quiz_loading=!0;var e=api_url+"lesson-quizzes/update";s.$http.post(e,t).then(e=>{"success"==e.body.status&&(t.old_question_name=t.question_name),s.curriculum.update_quiz_loading=!1},e=>{s.curriculum.update_quiz_loading=!1})},openLessonDialog:function(e,t){var s=this;s.lessons.item=Object.assign({},t),s.lessons.editedLessonIndex=s.curriculum.sections[e].items.indexOf(t),s.lessons.editedSectionIndex=e,s.lessons.item.meta=t.hasOwnProperty("meta")?t.meta:s.lessons.itemMetaDefault,s.lessons.item.quizzes=t.hasOwnProperty("quizzes")?t.quizzes:[],s.dialog=!0},removeFAQ:function(e){e=this.faq.items.indexOf(e);this.faq.items.splice(e,1)},removeSection:function(e){var t=this;t.curriculum.loading=!0;var s=t.curriculum.sections.indexOf(e),i=api_url+"course-sections/delete";data={course_id:t.course.course_id,section_id:e.section_id},t.$http.post(i,data).then(e=>{"success"==e.body.status&&t.curriculum.sections.splice(s,1),t.curriculum.loading=!1},e=>{t.curriculum.loading=!1})},removeLesson:function(t,e){var s=this;s.curriculum.loading=!0;var i=s.curriculum.sections[t],o=s.curriculum.sections[t].items.indexOf(e),a=api_url+"course-lessons/delete";data={section_id:i.section_id,lesson_id:e.lesson_id},s.$http.post(a,data).then(e=>{"success"==e.body.status&&s.curriculum.sections[t].items.splice(o,1),s.curriculum.loading=!1},e=>{s.curriculum.loading=!1})},removeQuiz:function(e,t){var s=this,i=api_url+"lesson-quizzes/delete";data={lesson_id:e.lesson_id,question_id:e.question_id},s.$http.post(i,data).then(e=>{"success"==e.body.status&&s.lessons.item.quizzes.splice(t,1)},e=>{})},removeQuestionAnswer:function(e,t){e.question_answers.splice(t,1),e.old_question_name+=" "},formatText:function(e){return e.split("").filter(e=>0<e.charCodeAt()).join("")},checkLessonNames:function(e){var t=e.old_lesson_name;return e.lesson_name==t},checkQuizNames:function(e){var t=e.old_question_name;return e.question_name==t},checkQuizType:function(e){"2"==e.question_type?(e.question_answers=[{answer:"Verdadero"},{answer:"Falso"}],e.correct_answer="Falso"):"3"==e.question_type&&(e.question_answers=[{answer:"",missing_words:""}])},matchWords:function(e){var t=e.answer,s=/\[([^\]]+)]/g,s=null!=t.match(s)?t.match(s):[],i=[];s.forEach((e,t)=>{e=(e=e.replace("[","")).replace("]","");i.push(e)}),e.missing_words=i},checkSectionNames:function(e){var t=e.old_section_name;return e.section_name==t},close:function(){this.$nextTick(()=>{this.alert=!1,this.lessons.item.meta=Object.assign({},this.lessons.itemMetaDefault)})}}});