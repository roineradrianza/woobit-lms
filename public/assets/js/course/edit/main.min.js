let vm=new Vue({vuetify:vuetify,el:"#app-container",data:{tab:null,nav_tab:null,alert:!1,dialog:!1,reminder:!1,loading:!1,page_loading:!1,percent_loading_active:!1,dialog:!1,valid:!1,saved:!1,dialogDelete:!1,zoomDateDialog:!1,zoomTimeDialog:!1,zoom_date_modal:!1,zoom_time_modal:!1,modal:!1,alert_message:"",alert_type:"",previewImage:"",currentImage:"",selectedItem:4,percent_loading:0,validations:validations,featured_image:"",min_age:4,max_age:18,age_range:[4,18],customToolbar:[["bold","italic","underline"],[{list:"ordered"},{list:"bullet"}],[{align:""},{align:"center"},{align:"right"},{align:"justify"}]],curriculum:{loading:!1,add_loading:!1,add_lesson_loading:!1,add_quiz_loading:!1,update_section_loading:!1,update_lesson_loading:!1,update_lesson_meta_loading:!1,sections:[]},notifications:[],lessons:{loading:!1,types:[{text:"Clasa",value:"1"}],class_types:[{text:"Zoom",value:"zoom_meeting"}],item:{quizzes:[],meta:{class_type:"zoom_meeting",duration:"",description:"",zoom_agenda:"",zoom_duration:"",zoom_date:"",zoom_time:"",zoom_start_time:"",zoom_timezone:"Europe/Bucharest",video:void 0,poster:void 0}},itemMetaDefault:{class_type:"zoom_meeting",duration:"",description:"",zoom_agenda:"",zoom_duration:"",zoom_date:"",zoom_time:"",zoom_start_time:"",zoom_timezone:"Europe/Bucharest",video:void 0,poster:void 0},editedLessonIndex:-1,editedSectionIndex:-1},categories:[],subcategories:[],filtered_subcategories:[],timezones:[],course:{course_id:void 0,featured_image:"",old_featured_image:"",new_featured_image:new File([],""),title:"",slug:"",price:"",duration:"",category:"",category_id:"",active:"1",min_students:1,max_students:20,min_age:4,max_age:18,meta:{description:""}}},computed:{},watch:{age_range(){this.course.min_age=this.age_range[0],this.course.max_age=this.age_range[1]}},created(){window.onload=()=>{check_google_user()}},mounted(){this.course.course_id=this.$refs.course_container.$el.getAttribute("course-id"),this.initialize(),this.initializeCategories(),this.initializeTimezones()},methods:{initialize(){var url=api_url+"courses/get/"+this.course.course_id;this.page_loading=!0,this.$http.get(url).then(res=>{res.body.length>0&&(this.course=res.body[0],this.course.featured_image="",this.course.new_featured_image=new File([],""),this.currentImage=res.body[0].featured_image,this.previewImage=this.currentImage,this.getCurriculum()),this.page_loading=!1},err=>{})},initializeCategories(){var url=api_url+"categories/get";this.categories_loading=!0,this.$http.get(url).then(res=>{this.categories_loading=!1,this.categories=res.body},err=>{})},initializeTimezones(){var app=this,url=domain+"/timezones.min.json";app.$http.get(url).then(res=>{app.timezones=res.body.timezone},err=>{})},getCurriculum(){var url=api_url+"course-sections/get",data={course_id:this.course.course_id};this.$http.post(url,data).then(res=>{this.curriculum.sections=res.body},err=>{})},save(){var app=this;app.loading=!0;var course=Object.assign({},app.course);course.section=JSON.stringify(app.curriculum.sections),course.meta=JSON.stringify(course.meta);let data=new FormData;for(var key in course)data.append(key,course[key]);var url=api_url+"courses/update";app.$http.post(url,data).then(res=>{"success"==res.body.status?(""!=res.body.data.featured_image&&(app.editedItem.featured_image=res.body.data.featured_image),app.response(res.body.status,res.body.message),app.loading=!0,app.course.slug=res.body.data.slug):app.loading=!1},err=>{app.response("error")})},prevImage(e){const image=e.target.files[0],reader=new FileReader;reader.readAsDataURL(image),reader.onload=e=>{this.course.featured_image=image,this.previewImage=e.target.result}},checkSectionMove(){var sections;this.curriculum.sections.forEach((section,i)=>{section.section_order=i})},checkLessonMove(index){var lessons;this.curriculum.sections[index].items.forEach((lesson,i)=>{lesson.lesson_order=i})},resetImage(){var app=this;app.previewImage=app.currentImage,app.course.featured_image=app.currentImage},filterSubcategories(){var app=this;app.$refs.subcategory_select.reset(),app.course.subcategory_id="";var result=app.subcategories.filter(subcategory=>subcategory.category_id==app.course.category_id);app.filtered_subcategories=result},getCategory(id){var app,result=this.categories.filter(e=>e.category_id==id);if(result.length>0)return result[0].name},addSection(){var app=this,id=app.curriculum.sections.length,order=-1==id?1:id,section={section_name:"Secțiunea "+ ++id,section_id:void 0,section_order:order,items:[],course_id:void 0};app.curriculum.sections.push(section)},addLesson(section_index,item){var app=this,section=app.curriculum.sections[section_index],i=section.items.indexOf(item),order=-1==i?0:i,id=section.items.length,lesson={lesson_name:"Ședința "+ ++id,old_lesson_name:"Ședința "+i,lesson_type:"1",lesson_order:order,meta:Object.assign({},app.lessons.itemMetaDefault),quizzes:[],resources:[]};app.curriculum.sections[section_index].items.push(lesson)},updateLessonMeta(){var app=this,lesson=app.lessons.item;Object.assign(app.curriculum.sections[app.lessons.editedSectionIndex].items[app.lessons.editedLessonIndex].meta,lesson.meta),app.dialog=!1},openLessonDialog(section_index,item){var app=this;app.lessons.item=Object.assign({},item),app.lessons.editedLessonIndex=app.curriculum.sections[section_index].items.indexOf(item),app.lessons.editedSectionIndex=section_index,app.lessons.item.meta=item.hasOwnProperty("meta")?item.meta:app.lessons.itemMetaDefault,app.lessons.item.quizzes=item.hasOwnProperty("quizzes")?item.quizzes:[],app.dialog=!0},removeSection(item){var app=this,id=app.curriculum.sections.indexOf(item);app.curriculum.sections.splice(id,1)},removeLesson(section_index,item){var app=this,section=app.curriculum.sections[section_index],id=app.curriculum.sections[section_index].items.indexOf(item);app.curriculum.sections[section_index].items.splice(id,1)},removeResource(resource,index){var app;this.lessons.item.resources.splice(index,1)},getExt(file_name){var url,splitted_url=file_name.split("/"),ext;return splitted_url[splitted_url.length-1].split(".")[1]},response(type="",message=""){this.loading=!1,this.alert=!0,this.alert_type=type,this.alert_message="error"==type&&""==message?"A apărut o eroare neașteptată, vă rugăm să încercați din nou.":message},close(){this.$nextTick(()=>{this.alert=!1,this.lessons.item.meta=Object.assign({},this.lessons.itemMetaDefault)})}}});