let vm=new Vue({vuetify:vuetify,el:"#app-container",data:{tab:null,nav_tab:null,alert:!1,dialog:!1,reminder:!1,loading:!1,percent_loading_active:!1,dialog:!1,valid:!1,saved:!1,dialogDelete:!1,zoomDateDialog:!1,zoomTimeDialog:!1,zoom_date_modal:!1,zoom_time_modal:!1,modal:!1,alert_message:"",alert_type:"",previewImage:"",currentImage:"",selectedItem:4,percent_loading:0,validations:validations,featured_image:"",min_age:4,max_age:18,age_range:[4,18],customToolbar:[["bold","italic","underline"],[{list:"ordered"},{list:"bullet"}],[{align:""},{align:"center"},{align:"right"},{align:"justify"}]],curriculum:{loading:!1,add_loading:!1,add_lesson_loading:!1,add_quiz_loading:!1,update_section_loading:!1,update_lesson_loading:!1,update_lesson_meta_loading:!1,sections:[]},notifications:[],lessons:{loading:!1,types:[{text:"Clasa",value:"1"}],class_types:[{text:"Zoom",value:"zoom_meeting"}],item:{quizzes:[],meta:{class_type:"zoom_meeting",duration:"",description:"",zoom_agenda:"",zoom_duration:"",zoom_date:"",zoom_time:"",zoom_start_time:"",zoom_timezone:"Europe/Bucharest",video:void 0,poster:void 0}},itemMetaDefault:{class_type:"zoom_meeting",duration:"",description:"",zoom_agenda:"",zoom_duration:"",zoom_date:"",zoom_time:"",zoom_start_time:"",zoom_timezone:"Europe/Bucharest",video:void 0,poster:void 0},editedLessonIndex:-1,editedSectionIndex:-1},categories:[],subcategories:[],filtered_subcategories:[],timezones:[],course:{featured_image:new File([],""),title:"",slug:"",price:"",duration:"",category:"",category_id:"",active:1,min_students:1,max_students:20,min_age:4,max_age:18,meta:{description:""}}},computed:{},watch:{age_range(){this.course.min_age=this.age_range[0],this.course.max_age=this.age_range[1]}},created(){window.onload=(()=>{check_google_user()}),this.editedItem=this.defaultItem,this.initializeCategories(),this.initializeTimezones()},mounted(){this.reminder=!0},methods:{initializeCategories(){var e=api_url+"categories/get";this.categories_loading=!0,this.$http.get(e).then(e=>{this.categories_loading=!1,this.categories=e.body},e=>{})},initializeTimezones(){var e=this,t=domain+"/timezones.min.json";e.$http.get(t).then(t=>{e.timezones=t.body.timezone},e=>{})},save(){var e=this;e.loading=!0;var t=Object.assign({},e.course);t.section=JSON.stringify(e.curriculum.sections),t.meta=JSON.stringify(t.meta);let s=new FormData;for(var i in t)s.append(i,t[i]);var o=api_url+"courses/create";e.$http.post(o,s).then(t=>{"success"==t.body.status?(e.response(t.body.status,t.body.message),e.saved=!0,e.course.slug=t.body.data.slug):e.loading=!1},t=>{e.response("error")})},prevImage(e){const t=e.target.files[0],s=new FileReader;s.readAsDataURL(t),s.onload=(e=>{this.course.featured_image=t,this.previewImage=e.target.result})},checkSectionMove(){var e=this.curriculum.sections;e.forEach((e,t)=>{e.section_order=t})},checkLessonMove(e){var t=this.curriculum.sections[e].items;t.forEach((e,t)=>{e.lesson_order=t})},resetImage(){var e=this;e.previewImage=e.currentImage,e.course.featured_image=e.currentImage},filterSubcategories(){var e=this;e.$refs.subcategory_select.reset(),e.course.subcategory_id="";var t=e.subcategories.filter(t=>t.category_id==e.course.category_id);e.filtered_subcategories=t},getCategory(e){var t=this,s=t.categories.filter(t=>t.category_id==e);if(s.length>0)return s[0].name},addSection(){var e=this,t=e.curriculum.sections.length,s=-1==t?1:t;t++;var i={section_name:"Secțiunea "+t,section_id:void 0,section_order:s,items:[],course_id:void 0};e.curriculum.sections.push(i)},addLesson(e,t){var s=this,i=s.curriculum.sections[e],o=i.items.indexOf(t),a=-1==o?0:o,r=i.items.length;r++;var n={lesson_name:"Ședința "+r,old_lesson_name:"Ședința "+o,lesson_type:"1",lesson_order:a,meta:Object.assign({},s.lessons.itemMetaDefault),quizzes:[],resources:[]};s.curriculum.sections[e].items.push(n)},updateLessonMeta(){var e=this,t=e.lessons.item;Object.assign(e.curriculum.sections[e.lessons.editedSectionIndex].items[e.lessons.editedLessonIndex].meta,t.meta),e.dialog=!1},openLessonDialog(e,t){var s=this;s.lessons.item=Object.assign({},t),s.lessons.editedLessonIndex=s.curriculum.sections[e].items.indexOf(t),s.lessons.editedSectionIndex=e,s.lessons.item.meta=t.hasOwnProperty("meta")?t.meta:s.lessons.itemMetaDefault,s.lessons.item.quizzes=t.hasOwnProperty("quizzes")?t.quizzes:[],s.dialog=!0},removeSection(e){var t=this,s=t.curriculum.sections.indexOf(e);t.curriculum.sections.splice(s,1)},removeLesson(e,t){var s=this,i=(s.curriculum.sections[e],s.curriculum.sections[e].items.indexOf(t));s.curriculum.sections[e].items.splice(i,1)},removeResource(e,t){var s=this;s.lessons.item.resources.splice(t,1)},getExt(e){var t=e,s=t.split("/"),i=s[s.length-1].split(".");return i[1]},response(e="",t=""){this.loading=!1,this.alert=!0,this.alert_type=e,this.alert_message="error"==e&&""==t?"A apărut o eroare neașteptată, vă rugăm să încercați din nou.":t},close(){this.$nextTick(()=>{this.alert=!1,this.lessons.item.meta=Object.assign({},this.lessons.itemMetaDefault)})}}});