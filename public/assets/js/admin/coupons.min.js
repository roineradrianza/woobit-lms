let vm=new Vue({vuetify:vuetify,el:"#full-learning-container",data:{loading:!1,table_loading:!1,courses_loading:!1,dialog:!1,valid:!1,dialogDelete:!1,modal:!1,drawer:!0,selectedItem:5,rol_options:[{text:"Estudiante",value:"estudiante"},{text:"Residente",value:"residente"},{text:"Profesor",value:"profesor"},{text:"Oyente",value:"oyente"}],courses:[],validations:validations,headers:[{text:"Nombre del cupón",align:"start",value:"coupon_name"},{text:"Rol del usuario",value:"student_rol"},{text:"Descuento",value:"discount"},{text:"Acciones",value:"actions",align:"center",sortable:!1}],coupons:[],editedIndex:-1,editedItem:{},defaultItem:{coupon_name:"",student_rol:"estudiante",discount:"",course_id:"",coupon_id:""}},computed:{formTitle(){return-1===this.editedIndex?"Crear cupón":"Modificar cupón"}},watch:{dialog(e){e||this.close()},dialogDelete(e){e||this.closeDelete()}},created(){check_google_user(),this.editedItem=this.defaultItem,this.loadCourses(),this.initialize()},mounted(){},methods:{initialize(){var e=api_url+"coupons/get";this.table_loading=!0,this.$http.get(e).then(e=>{this.table_loading=!1,this.coupons=e.body},e=>{})},loadCourses(){var e=api_url+"courses/get-courses";this.courses_loading=!0,this.$http.get(e).then(e=>{this.courses_loading=!1;e.body.length>0&&(this.courses=e.body)},e=>{})},editItem(e){this.editedIndex=this.coupons.indexOf(e),this.editedItem=Object.assign({},e),this.dialog=!0},deleteItem(e){this.editedIndex=this.coupons.indexOf(e),this.editedItem=Object.assign({},e),this.dialogDelete=!0},deleteItemConfirm(){var e=this.editedItem.coupon_id,t=api_url+"coupons/delete";this.$http.post(t,{coupon_id:e}).then(e=>{"success"==e.body.status&&this.coupons.splice(this.editedIndex,1),this.closeDelete()},e=>{this.closeDelete()})},closeDelete(){this.dialogDelete=!1,this.$nextTick(()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},close(){this.dialog=!1,this.$nextTick(()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},save(){var e=this,t=e.editedIndex,s=e.editedItem;if(e.editedIndex>-1){var i=api_url+"coupons/update";e.$http.post(i,s).then(i=>{"success"==i.body.status&&Object.assign(e.coupons[t],s),e.close()},e=>{})}else{i=api_url+"coupons/create";e.$http.post(i,s).then(t=>{"success"==t.body.status&&(s.coupon_id=t.body.data.coupon_id,e.coupons.push(s)),e.close()},t=>{e.close()})}},validate(){this.$refs.form.validate()}}});