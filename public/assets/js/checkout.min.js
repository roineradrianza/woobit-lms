Vue.use(VueTelInputVuetify,{vuetify:vuetify}),moment.locale("ru");let vm=new Vue({vuetify:vuetify,el:"#app-container",data:{already_paid:!1,loading:!1,loading_btn:!1,alert:!1,alert_type:!1,alert_message:!1,tab:null,nav_tab:null,notifications:[],course_id:url_params.get("course_id"),title:url_params.get("course"),extra:url_params.get("extra"),personal_info:basic_info,paypal:{},children:new Children({uid:uid}),initial_pay:0,info:{course_id:"",total_pay:0,payment_method:"Paypal",meta:{USD:0,usd_tax_day:0}}},computed:{FullName(){return this.personal_info.first_name+" "+this.personal_info.last_name},AmountInUSD(){var e=this.info.total_pay/this.info.meta.usd_tax_day,a=new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RON"});return a.format(e)}},created(){check_google_user()},mounted(){this.initialize()},methods:{initialize(){var e=this,a=api_url+"courses/get/"+e.course_id;e.checkout_loading=!0,e.children.load(),e.$http.get(a).then(a=>{if(e.checkout_loading=!1,a.body.length>0){var t=a.body[0];e.info.course_id=e.course_id,e.info.type=1,e.initial_pay=t.price,e.getRONtoUSDTax()}},e=>{})},fillPpCheckout(){var e=this;total_pay=e.info.total_pay,pp_pay=e.info.meta.USD,null!=e.$refs.paypal_container&&(e.$refs.paypal_container.innerHTML=""),e.info.total_pay>=e.initial_pay&&paypal.Buttons({style:{color:"blue",shape:"pill",label:"pay",height:40},createOrder:(a,t)=>t.order.create({purchase_units:[{amount:{value:pp_pay,breakdown:{item_total:{value:pp_pay,currency_code:"USD"}}},items:[{name:e.title,unit_amount:{value:pp_pay,currency_code:"USD"},quantity:"1"}]}]}),onApprove:(a,t)=>t.order.capture().then(a=>{e.info.meta.pp_order_id=a.id,e.info.meta.pp_transaction_id=a.purchase_units[0].payments.captures[0].id,e.info.meta.pp_state=1,e.info.meta.total_paid=pp_pay,e.pay()})}).render("#paypal-button-container")},getInput(e,a){this.personal_info.telephone=a.number.international},pay(){var e=this,a=e.info;e.loading_btn=!0,a.meta.first_name=e.personal_info.first_name,a.meta.user_email=e.personal_info.email,a.meta.last_name=e.personal_info.last_name,a.meta.telephone=e.personal_info.telephone,a.meta.address=e.personal_info.address,a.meta.course=e.title;var t=api_url+"orders/create";e.$http.post(t,a).then(a=>{e.loading_btn=!1,e.alert=!0,e.alert_message=a.body.message,e.alert_type=a.body.status,"success"==a.body.status&&(e.already_paid=!0,window.location=domain+"/profile/?tab=orders_container")},a=>{e.loading_btn=!1})},getRONtoUSDTax(){var e=this,a=`https://freecurrencyapi.net/api/v2/latest?apikey=${free_currency_api_key}&base_currency=USD`;e.info.meta.usd_tax_day<=0?e.$http.get(a).then(a=>{a.body.data.hasOwnProperty("RON")&&(e.info.meta.usd_tax_day=a.body.data.RON,e.info.meta.USD=(e.info.total_pay/e.info.meta.usd_tax_day).toFixed(2),e.fillPpCheckout())},e=>{}):(e.info.meta.USD=(e.info.total_pay/e.info.meta.usd_tax_day).toFixed(2),e.fillPpCheckout())}}});